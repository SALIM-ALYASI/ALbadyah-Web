# ูุธุงู ุชุณุฌูู ุงูุฏุฎูู ุงููุจุณุท ูุงููุญูู

## ๐ ูุธุฑุฉ ุนุงูุฉ

ุชู ุชุทููุฑ ูุธุงู ุชุณุฌูู ุฏุฎูู ูุจุณุท ูุณุชูุจู ูุชุบูุฑ ูุงุญุฏ ููุท ูุน ุญูุงูุฉ ูุชูุฏูุฉ ุถุฏ ูุญุงููุงุช ุงูุชูุงุนุจ ูุงูุงุฎุชุฑุงู.

## โจ ุงููููุฒุงุช ุงูุฌุฏูุฏุฉ

### ๐ **ูุชุบูุฑ ูุงุญุฏ ููุท**
- **ููุชุงุญ ุฏุฎูู ูุงุญุฏ**: `admin_key` ุจุฏูุงู ูู ุงุณู ูุณุชุฎุฏู ููููุฉ ูุฑูุฑ
- **ุจุณุงุทุฉ ูู ุงูุงุณุชุฎุฏุงู**: ุญูู ูุงุญุฏ ููุท ููุฏุฎูู
- **ุฃูุงู ูุญุณู**: ุชุดููุฑ SHA256 ููููุงุฑูุฉ

### ๐ก๏ธ **ุญูุงูุฉ ูุชูุฏูุฉ ุถุฏ ุงูุชูุงุนุจ**

#### **Rate Limiting (ููุน ุงููุญุงููุงุช ุงููุชูุฑุฑุฉ)**
- **ููุน ุงููุญุงููุงุช ุงูุณุฑูุนุฉ**: ูุง ูููู ุงููุญุงููุฉ ุฃูุซุฑ ูู ูุฑุฉ ูู 3 ุซูุงูู
- **ุญุฏ ุฃูุตู ูููุญุงููุงุช**: 5 ูุญุงููุงุช ูู 10 ุฏูุงุฆู ููู IP
- **ุญุธุฑ ูุคูุช**: ููุน ุงููุญุงููุงุช ููุฏุฉ 10 ุฏูุงุฆู ุนูุฏ ุชุฌุงูุฒ ุงูุญุฏ

#### **ูุฑุงูุจุฉ ุนููุงู IP**
- **ุชุชุจุน IP**: ุฑุจุท ุงูุฌูุณุฉ ุจุนููุงู IP
- **ุญูุงูุฉ ูู ุณุฑูุฉ ุงูุฌูุณุฉ**: ุฅููุงุก ุงูุฌูุณุฉ ุนูุฏ ุชุบููุฑ IP
- **ุฃูุงู ุฅุถุงูู**: ููุน ุงููุตูู ูู ุนูุงููู ูุฎุชููุฉ

#### **ุชุดููุฑ ูุชูุฏู**
- **SHA256 Hashing**: ุชุดููุฑ ููุชุงุญ ุงูุฏุฎูู
- **ููุงุฑูุฉ ุขููุฉ**: ุนุฏู ุชุฎุฒูู ุงูููุชุงุญ ูู ูุต ูุงุถุญ
- **ุญูุงูุฉ ุงูุจูุงูุงุช**: ุชุดููุฑ ุฌููุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ

## ๐ ุงูุชุทุจูู

### **1. ูุชุบูุฑุงุช ุงูุจูุฆุฉ**

#### ูู ููู `.env`:
```env
ADMIN_SECRET=admin123
```

### **2. AdminController ุงููุญุฏุซ**

#### **ุชุณุฌูู ุงูุฏุฎูู ุงููุญุณู:**
```php
public function login(Request $request)
{
    // Rate Limiting - ููุน ุงููุญุงููุงุช ุงููุชูุฑุฑุฉ
    $ip = $request->ip();
    $attempts = session("login_attempts_{$ip}", 0);
    $lastAttempt = session("last_attempt_{$ip}", 0);
    
    // ููุน ุงููุญุงููุงุช ุงูุณุฑูุนุฉ (ุฃูู ูู 3 ุซูุงูู)
    if (time() - $lastAttempt < 3) {
        return back()->withErrors([
            'credentials' => 'ูุญุงููุฉ ุฏุฎูู ุณุฑูุนุฉ ุฌุฏุงูุ ุงูุชุธุฑ ููููุงู'
        ]);
    }
    
    // ููุน ุฃูุซุฑ ูู 5 ูุญุงููุงุช ูู 10 ุฏูุงุฆู
    if ($attempts >= 5 && (time() - session("first_attempt_{$ip}", time())) < 600) {
        return back()->withErrors([
            'credentials' => 'ุชู ุชุฌุงูุฒ ุนุฏุฏ ุงููุญุงููุงุช ุงููุณููุญุ ุญุงูู ูุฑุฉ ุฃุฎุฑู ุจุนุฏ 10 ุฏูุงุฆู'
        ]);
    }
    
    // ุงูุชุญูู ูู ุตุญุฉ ุงูููุชุงุญ ูุน ุชุดููุฑ SHA256
    $adminSecret = env('ADMIN_SECRET', 'admin123');
    $inputKey = $request->admin_key;
    
    if (hash('sha256', $inputKey) === hash('sha256', $adminSecret)) {
        // ูุณุญ ุนุฏุงุฏ ุงููุญุงููุงุช ุนูุฏ ูุฌุงุญ ุงูุฏุฎูู
        session()->forget([
            "login_attempts_{$ip}",
            "last_attempt_{$ip}",
            "first_attempt_{$ip}"
        ]);
        
        // ุชุนููู ุฌูุณุฉ ุงูุฅุฏูู ูุน ุจูุงูุงุช ุฅุถุงููุฉ
        session([
            'admin_access' => true,
            'admin_secret' => env('ADMIN_SECRET'),
            'admin_login_time' => time(),
            'admin_ip' => $ip,
            'admin_session_id' => uniqid('admin_', true)
        ]);
        
        return redirect()->route('governorates.index')
            ->with('success', 'ูุฑุญุจุงู ุจู ูู ููุญุฉ ุงูุชุญูู');
    }
}
```

### **3. Middleware ุงููุญุณู**

#### **ุญูุงูุฉ ุฅุถุงููุฉ:**
```php
public function handle(Request $request, Closure $next): Response
{
    // ุงูุชุญูู ูู ูุฌูุฏ ุฌูุณุฉ ุฅุฏุงุฑูุฉ ุตุญูุญุฉ
    if (!session('admin_access') || session('admin_secret') !== env('ADMIN_SECRET')) {
        return redirect()->route('admin.login')->with('error', 'ูุฌุจ ุชุณุฌูู ุงูุฏุฎูู');
    }
    
    // ุงูุชุญูู ูู IP - ุญูุงูุฉ ุถุฏ ุณุฑูุฉ ุงูุฌูุณุฉ
    $sessionIp = session('admin_ip');
    $currentIp = $request->ip();
    if ($sessionIp && $sessionIp !== $currentIp) {
        session()->forget([
            'admin_access', 'admin_secret', 'admin_login_time', 
            'admin_ip', 'admin_session_id'
        ]);
        return redirect()->route('admin.login')->with('error', 'ุชู ุงูุชุดุงู ุชุบููุฑ ูู ุนููุงู IP');
    }
    
    // ุงูุชุญูู ูู ุงูุชูุงุก ุตูุงุญูุฉ ุงูุฌูุณุฉ
    $sessionTimeout = session('admin_login_time');
    if ($sessionTimeout && (time() - $sessionTimeout) > 7200) {
        session()->forget([
            'admin_access', 'admin_secret', 'admin_login_time', 
            'admin_ip', 'admin_session_id'
        ]);
        return redirect()->route('admin.login')->with('error', 'ุงูุชูุช ุตูุงุญูุฉ ุงูุฌูุณุฉ');
    }
    
    return $next($request);
}
```

### **4. ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู ุงููุจุณุทุฉ**

#### **ุญูู ูุงุญุฏ ููุท:**
```html
<div class="mb-4">
    <label for="admin_key" class="form-label">
        <i class="fas fa-key me-1"></i>
        ููุชุงุญ ุงูุฏุฎูู ุงูุฅุฏุงุฑู
    </label>
    <div class="input-group">
        <input type="password" 
               class="form-control @error('admin_key') is-invalid @enderror" 
               id="admin_key" 
               name="admin_key" 
               placeholder="ุฃุฏุฎู ููุชุงุญ ุงูุฏุฎูู ุงูุฅุฏุงุฑู"
               required
               autofocus
               minlength="6">
        <span class="input-group-text">
            <i class="fas fa-key"></i>
        </span>
    </div>
</div>
```

#### **ูุนูููุงุช ุงูุฃูุงู:**
```html
<div class="credentials-info">
    <h6>ูุนูููุงุช ุงูุฃูุงู</h6>
    <div class="mb-2">
        <small>ููุชุงุญ ุงูุฏุฎูู:</small><br>
        <strong>{{ env('ADMIN_SECRET', 'admin123') }}</strong>
    </div>
    <div class="row">
        <div class="col-12 mb-1">
            <small><i class="fas fa-clock me-1"></i>ุงูุฌูุณุฉ ุชูุชูู ุชููุงุฆูุงู ุจุนุฏ ุณุงุนุชูู</small>
        </div>
        <div class="col-12 mb-1">
            <small><i class="fas fa-ban me-1"></i>ุญุฏ ุฃูุตู 5 ูุญุงููุงุช ูู 10 ุฏูุงุฆู</small>
        </div>
        <div class="col-12">
            <small><i class="fas fa-network-wired me-1"></i>ูุฑุงูุจุฉ ุนููุงู IP ููุฃูุงู</small>
        </div>
    </div>
</div>
```

## ๐ ูุณุชููุงุช ุงูุญูุงูุฉ

### **ุงููุณุชูู ุงูุฃูู: Rate Limiting**
- **ููุน ุงููุญุงููุงุช ุงูุณุฑูุนุฉ**: 3 ุซูุงูู ุจูู ุงููุญุงููุงุช
- **ุญุฏ ุฃูุตู ูููุญุงููุงุช**: 5 ูุญุงููุงุช ูู 10 ุฏูุงุฆู
- **ุญุธุฑ ูุคูุช**: 10 ุฏูุงุฆู ุนูุฏ ุชุฌุงูุฒ ุงูุญุฏ

### **ุงููุณุชูู ุงูุซุงูู: ุชุดููุฑ ุงูุจูุงูุงุช**
- **SHA256 Hashing**: ุชุดููุฑ ููุชุงุญ ุงูุฏุฎูู
- **ููุงุฑูุฉ ุขููุฉ**: ุนุฏู ุชุฎุฒูู ุงููุต ุงููุงุถุญ
- **ุญูุงูุฉ ุงูุจูุงูุงุช**: ุชุดููุฑ ุฌููุน ุงูุจูุงูุงุช ุงูุญุณุงุณุฉ

### **ุงููุณุชูู ุงูุซุงูุซ: ูุฑุงูุจุฉ IP**
- **ุชุชุจุน ุนููุงู IP**: ุฑุจุท ุงูุฌูุณุฉ ุจุนููุงู IP
- **ุญูุงูุฉ ูู ุณุฑูุฉ ุงูุฌูุณุฉ**: ุฅููุงุก ุงูุฌูุณุฉ ุนูุฏ ุชุบููุฑ IP
- **ุฃูุงู ุฅุถุงูู**: ููุน ุงููุตูู ูู ุนูุงููู ูุฎุชููุฉ

### **ุงููุณุชูู ุงูุฑุงุจุน: ุฅุฏุงุฑุฉ ุงูุฌูุณุงุช**
- **ุงูุชูุงุก ุตูุงุญูุฉ ุชููุงุฆู**: ุจุนุฏ ุณุงุนุชูู
- **ูุนุฑู ุฌูุณุฉ ูุฑูุฏ**: `admin_session_id`
- **ุชูุธูู ุชููุงุฆู**: ุญุฐู ุฌููุน ุงูุจูุงูุงุช ุนูุฏ ุงูุฎุฑูุฌ

## ๐ ููููุฉ ุงูุงุณุชุฎุฏุงู

### **1. ุชุณุฌูู ุงูุฏุฎูู:**
```
http://127.0.0.1:8000/admin/login
```

**ุงูุจูุงูุงุช:**
- **ููุชุงุญ ุงูุฏุฎูู**: ูููุฉ `ADMIN_SECRET` ูู ููู `.env`

### **2. ุชุบููุฑ ููุชุงุญ ุงูุฏุฎูู:**
```env
# ูู ููู .env
ADMIN_SECRET=ููุชุงุญ_ุฌุฏูุฏ_ููู
```

### **3. ุงููุตูู ูููุญุฉ ุงูุชุญูู:**
```
http://127.0.0.1:8000/dashboard/governorates
```

## โ๏ธ ุงูุญูุงูุฉ ุถุฏ ุงูุชูุงุนุจ

### **โ ุงูุญูุงูุฉ ุงููุทุจูุฉ:**
- **ููุน ุงููุญุงููุงุช ุงููุชูุฑุฑุฉ**: Rate limiting
- **ูุฑุงูุจุฉ ุนููุงู IP**: ุญูุงูุฉ ูู ุณุฑูุฉ ุงูุฌูุณุฉ
- **ุชุดููุฑ ุงูุจูุงูุงุช**: SHA256 hashing
- **ุงูุชูุงุก ุตูุงุญูุฉ ุชููุงุฆู**: ุจุนุฏ ุณุงุนุชูู
- **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ**: ุจุงููุบุฉ ุงูุนุฑุจูุฉ

### **โ ูุง ุชู ููุนู:**
- **ูุญุงููุงุช ุฏุฎูู ูุชูุฑุฑุฉ**: ุฃูุซุฑ ูู 5 ูู 10 ุฏูุงุฆู
- **ูุญุงููุงุช ุณุฑูุนุฉ**: ุฃูู ูู 3 ุซูุงูู ุจูู ุงููุญุงููุงุช
- **ุชุบููุฑ ุนููุงู IP**: ุฅููุงุก ุงูุฌูุณุฉ ุชููุงุฆูุงู
- **ุฌูุณุงุช ููุชููุฉ ุงูุตูุงุญูุฉ**: ุฅุนุงุฏุฉ ุชูุฌูู ูุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู

## ๐ง ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### **ุฎุทุฃ: "ูุญุงููุฉ ุฏุฎูู ุณุฑูุนุฉ ุฌุฏุงู"**
```bash
# ุงูุชุธุฑ 3 ุซูุงูู ูุจู ุงููุญุงููุฉ ุงูุชุงููุฉ
```

### **ุฎุทุฃ: "ุชู ุชุฌุงูุฒ ุนุฏุฏ ุงููุญุงููุงุช ุงููุณููุญ"**
```bash
# ุงูุชุธุฑ 10 ุฏูุงุฆู ูุจู ุงููุญุงููุฉ ูุฑุฉ ุฃุฎุฑู
```

### **ุฎุทุฃ: "ุชู ุงูุชุดุงู ุชุบููุฑ ูู ุนููุงู IP"**
```bash
# ุณุฌู ุฏุฎูู ูุฑุฉ ุฃุฎุฑู ูู ููุณ ุงูุนููุงู
```

### **ุฎุทุฃ: "ุงูุชูุช ุตูุงุญูุฉ ุงูุฌูุณุฉ"**
```bash
# ุณุฌู ุฏุฎูู ูุฑุฉ ุฃุฎุฑู
```

## ๐ฏ ุงููุชูุฌุฉ ุงูููุงุฆูุฉ

โ **ูุธุงู ุฏุฎูู ูุจุณุท - ูุชุบูุฑ ูุงุญุฏ ููุท**  
โ **ุญูุงูุฉ ูุชูุฏูุฉ ุถุฏ ุงูุชูุงุนุจ**  
โ **Rate limiting ุฐูู**  
โ **ูุฑุงูุจุฉ ุนููุงู IP**  
โ **ุชุดููุฑ SHA256**  
โ **ุฅุฏุงุฑุฉ ุฌูุณุงุช ูุญุณูุฉ**  
โ **ุฑุณุงุฆู ุฎุทุฃ ูุงุถุญุฉ**  
โ **ุฃูุงู ูุชุนุฏุฏ ุงููุณุชููุงุช**  

ุงููุธุงู ุงูุขู ุฃุจุณุท ูุฃูุซุฑ ุฃูุงูุงู! ๐โจ
